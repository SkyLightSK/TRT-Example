<div class="dashboard">
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <div class="actions">
      <button class="btn btn-primary" (click)="refreshData()">Refresh Data</button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading dashboard data...</p>
  </div>

  <div *ngIf="!loading" class="dashboard-grid">
    <!-- Budget Summary Card -->
    <div class="card budget-summary">
      <div class="card-header">
        <h2>Budget Summary</h2>
        <span class="badge">{{ budgetSummary?.year }}</span>
      </div>
      <div class="card-content">
        <div class="metric">
          <div class="metric-value">{{ formatCurrency(budgetSummary?.totalBudget || 0) }}</div>
          <div class="metric-label">Total Budget</div>
        </div>
        <div class="metric">
          <div class="metric-value">{{ formatCurrency(budgetSummary?.spentToDate || 0) }}</div>
          <div class="metric-label">Spent to Date</div>
        </div>
        <div class="metric">
          <div class="metric-value">{{ budgetSummary?.utilization || 0 }}%</div>
          <div class="metric-label">Utilization</div>
        </div>
      </div>
      <div class="card-footer">
        <div class="progress-bar">
          <div class="progress" [style.width]="(budgetSummary?.utilization || 0) + '%'"></div>
        </div>
      </div>
    </div>

    <!-- Device Status Card -->
    <div class="card device-status">
      <div class="card-header">
        <h2>Device Status</h2>
        <span class="badge">All Locations</span>
      </div>
      <div class="card-content">
        <div class="status-grid">
          <div class="status-item">
            <div class="status-count">{{ deviceStatusSummary?.active || 0 }}</div>
            <div class="status-label active">Active</div>
          </div>
          <div class="status-item">
            <div class="status-count">{{ deviceStatusSummary?.needsAttention || 0 }}</div>
            <div class="status-label warning">Needs Attention</div>
          </div>
          <div class="status-item">
            <div class="status-count">{{ deviceStatusSummary?.critical || 0 }}</div>
            <div class="status-label danger">Critical</div>
          </div>
          <div class="status-item">
            <div class="status-count">{{ deviceStatusSummary?.endOfLife || 0 }}</div>
            <div class="status-label neutral">End of Life</div>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <a routerLink="/hardware" class="link-btn">View All Devices</a>
      </div>
    </div>

    <!-- Notifications Card -->
    <div class="card notifications">
      <div class="card-header">
        <h2>Recent Notifications</h2>
      </div>
      <div class="card-content">
        <div class="notification-list">
          <div class="notification {{ notification.type }}" *ngFor="let notification of recentNotifications">
            <div class="notification-icon">
              <span *ngIf="notification.type === 'warning'">‚ö†Ô∏è</span>
              <span *ngIf="notification.type === 'info'">‚ÑπÔ∏è</span>
              <span *ngIf="notification.type === 'danger'">üö®</span>
            </div>
            <div class="notification-content">
              <div class="notification-title">{{ notification.title }}</div>
              <div class="notification-message">{{ notification.message }}</div>
              <div class="notification-time">{{ getTimeAgo(notification.createdAt) }}</div>
            </div>
          </div>
          
          <div class="empty-state" *ngIf="recentNotifications.length === 0">
            <p>No recent notifications</p>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <a routerLink="/notifications" class="link-btn">View All Notifications</a>
      </div>
    </div>

    <!-- Upcoming End of Life Card -->
    <div class="card upcoming-eol">
      <div class="card-header">
        <h2>Upcoming End of Life</h2>
      </div>
      <div class="card-content">
        <table class="eol-table" *ngIf="upcomingEolDevices.length > 0">
          <thead>
            <tr>
              <th>Device</th>
              <th>Location</th>
              <th>EOL Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let device of upcomingEolDevices">
              <td>{{ device.manufacturer }} {{ device.model }}</td>
              <td>{{ device.location }}</td>
              <td>{{ formatDate(device.endOfLife) }}</td>
              <td>
                <span class="badge {{ getEolStatusClass(getDaysUntilEol(device.endOfLife)) }}">
                  {{ getDaysUntilEol(device.endOfLife) }} days
                </span>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="empty-state" *ngIf="upcomingEolDevices.length === 0">
          <p>No devices approaching end of life in the next 90 days</p>
        </div>
      </div>
      <div class="card-footer">
        <a routerLink="/hardware" class="link-btn">View All Devices</a>
      </div>
    </div>
  </div>
</div> 